# 使用场景

场景按照大类和小类来划分，大类用二级标题标识，如：

```markdown
## 1. 异常检测
```

小类用三级标题标识，且排列在相应的大类之下，如：

```markdown
## 2. 稳态分析

### 2.1 服务依赖分析
```

简单描述各大类及小类的范围即可。

## 1. 异常检测

异常检测指的是定位和排查一些引发系统异常行为的请求。通常这些请求的出现频率通常很低，其出现属于小概率事件。小概率事件的信息熵大，能给到开发者更多关于其维护系统的细节信息。这些细节可能体现在：慢请求、慢查询、循环调用未设上限、存在错误级别日志、未覆盖测试的问题逻辑分支等等。

## 2. 稳态分析

稳态分析指的是分析服务在正常流量下的各方面状态，分析粒度可能包括单个接口、单个服务、多个服务等等；分析角度可能包括埋点指标、依赖关系、流量大小等等。稳态分析通常反映的是系统核心流程的状态，一些配置的改动，如存储节点修改、客户端日志上报频率，都可能反馈到系统稳态。

### 2.1 稳态性能分析

定位和排查系统稳态中的性能问题，这些问题的起因通常与异常检测类似，只是其影响尚不足以触发报警。

### 2.2 服务依赖分析

构建接口级别的依赖关系图，节点通常为接口或服务，边通常为接口或服务的调用关系，边的权重则为流量。构建方式可以分为离线构建和在线构建，对应的就是静态关系图或动态关系图。这些信息可以以基础 API 的方式提供给上游应用使用，如 APM。

## 3. 分布式侧写

许多编程语言都提供侧写工具，如 go tool pprof，能通过采集不同资源的使用负载，如 CPU、内存、协程等，分析进程内部不同模块的资源使用模式，最后通过调用图 (call graph) 或火焰图 (flame graph) 等可视化方式呈现给开发者。分布式侧写就是这类侧写工具的分布式版本，能够在线运行侧写工具，观察关键链路的性能指标。

## 4. 资源归因

资源归因解答的主要问题是：“谁该为我的服务成本买单？” 它需要将资源消耗或占用与请求方关联，资源归因也是成本分析的基础。

## 5. 负载建模

负载建模主要指分析和推测系统的行为状态，回答的问题是 “如果出现 XX 变化，系统整体或关键链路状态会发生什么改变？” 常见应用如容量预估、全链路压测、混沌测试等等。